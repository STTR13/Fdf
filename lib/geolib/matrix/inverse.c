/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   inverse.c                                          :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: staeter <marvin@42.fr>                     +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2019/03/05 10:47:18 by staeter           #+#    #+#             */
/*   Updated: 2019/03/05 10:47:19 by staeter          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "geometry.h"

matrix			*adj(matrix m, matrix *ret)
{
	*ret[0][0] = m[1][1] * m[2][2] - m[1][2] * m[2][1];
	*ret[0][1] = - (m[0][1] * m[2][2] - m[0][2] * m[2][1]);
	*ret[0][2] = m[0][1] * m[1][2] - m[0][2] * m[1][1];
	*ret[1][0] = - (m[1][0] * m[2][2] - m[1][2] * m[2][0]);
	*ret[1][1] = m[0][0] * m[2][2] - m[0][2] * m[2][0];
	*ret[1][2] = - (m[0][0] * m[1][2] - m[0][2] * m[1][0]);
	*ret[2][0] = m[1][0] * m[2][1] - m[1][1] * m[2][0];
	*ret[2][1] = - (m[0][0] * m[2][1] - m[0][1] * m[2][0]);
	*ret[2][2] = m[0][0] * m[1][1] - m[0][1] * m[1][0];
	return (ret);
}

double			det(matrix m)
{
	matrix a;

	adj(m, &a);
	return (
		a[0][0] * m[0][0]
		+ a[0][1] * m[1][0]
		+ a[0][2] * m[2][0]
	);
}

matrix			*inv(matrix m, matrix *ret)
{
	matrix	a;
	double	det;

	adj(m, &a);
	det = a[0][0] * m[0][0]
		+ a[0][1] * m[1][0]
		+ a[0][2] * m[2][0];
	return ((det == 0) ? I(ret) : scal_m(a, 1 / det, ret));
}
